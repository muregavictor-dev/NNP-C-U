<!-- ===========================
    Floating Widgets Section
    Reusable on all pages
    Includes:
    - WhatsApp Floating Button
    - AI Chatbot Button + Panel
    - Notification Bell + Panel
    - Membership Modal
    - Video Lightbox
    - Image Lightbox
=========================== -->

<!-- 🌿 WhatsApp Floating Button -->
<a href="https://wa.me/0742812494?text=Hello%20NNP%20Christian%20Union" 
   target="_blank" 
   class="floating-whatsapp" 
   aria-label="Chat with us on WhatsApp">
  <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="white" class="bi bi-whatsapp" viewBox="0 0 16 16">
    <path d="M13.601 2.326A7.8 7.8 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L.055 15l4.205-1.332a7.8 7.8 0 0 0 3.794.757h.001c4.365 0 7.922-3.558 7.921-7.926zM7.994 14.621A6.602 6.602 0 0 1 5.56 13.565l-.356-.213-3.072.973.992-3.045-.224-.366A6.611 6.611 0 0 1 1.34 7.926c0-3.64 2.96-6.602 6.602-6.602s6.602 2.96 6.602 6.602c0 3.64-2.96 6.602-6.602 6.602"/>
  </svg>
</a>

<!-- 🤖 AI Chat Floating Button -->
<button class="floating-chat-toggle btn btn-primary-green rounded-circle shadow-lg" 
        id="chatboxToggle" 
        aria-label="Open AI Chat Widget" 
        data-bs-toggle="offcanvas" 
        data-bs-target="#aiChatbox" 
        aria-controls="aiChatbox">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" class="bi bi-robot" viewBox="0 0 16 16">
    <path d="M5.725 1.503a.5.5 0 0 1-.411.579c-.58.101-.986.353-1.246.67A1.666 1.666 0 0 0 3 4.098c-.378 0-.66.215-.9.41a2.5 2.5 0 0 0-.81 1.78l.006.37a.9.9 0 0 1 0 .285v1.272l-.34.113a.9.9 0 0 1-.6.046A1.86 1.86 0 0 1 0 7.846v3.424c0 .8.54 1.488 1.34 1.696l.48.12a2.9 2.9 0 0 0 1.25.07c.56-.12.83-.55 1.1-.92.27-.37.52-.75.82-1.07.3-.32.65-.6.98-.82.33-.22.69-.36 1.05-.44a3 3 0 0 1 1.38 0c.36.08.72.22 1.05.44.33.22.68.5.98.82.3.32.55.7.82 1.07.27.37.54.8.84.92.3.12.63.14 1.25-.07l.48-.12c.8-.208 1.34-.896 1.34-1.696V7.846a1.86 1.86 0 0 1-.95-1.74l.006-.37c0-.58-.29-1.12-.81-1.78-.24-.195-.52-.41-.9-.41a1.666 1.666 0 0 0-1.06-.92c-.26-.317-.66-.57-1.24-.67a.5.5 0 0 1-.41-.58L10.275 1.5h-4.55zM8 12.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"/>
  </svg>
</button>

<!-- 🔔 Notification Button -->
<button class="btn btn-outline-deep-green position-relative" id="openNotificationsBtn">
  <i class="bi bi-bell-fill"></i>
  <span id="notificationBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
    1
  </span>
</button>

<!-- 🪧 Notification Panel -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="notificationPanel" aria-labelledby="notificationPanelLabel">
  <div class="offcanvas-header bg-deep-green text-white">
    <h5 class="offcanvas-title" id="notificationPanelLabel">
      Notifications (<span id="unreadCount">1</span> Unread)
    </h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close Notifications"></button>
  </div>
  <div class="offcanvas-body">
    <div id="notificationItem" class="alert alert-gold border-start border-4 border-deep-green p-3" role="alert">
      <h6 class="alert-heading fw-bold">Event RSVP Confirmed!</h6>
      <p class="mb-0 small">You have successfully RSVP'd for the <strong>Campus Evangelism</strong> on Oct 27th to 1st NOV.</p>
      <button id="markAsReadBtn" class="btn btn-sm btn-link p-0 mt-2 text-deep-green" aria-label="Mark notification as read">
        Mark as Read
      </button>
    </div>
    <p class="text-soft-gray small mt-4">No older notifications.</p>
  </div>
</div>

<!-- 🤖 AI Chat Offcanvas -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="aiChatbox" aria-labelledby="aiChatboxLabel" style="width: 350px;">
  <div class="offcanvas-header bg-deep-green text-white">
    <h5 class="offcanvas-title" id="aiChatboxLabel">CU Assistant Bot</h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close Chat Widget"></button>
  </div>
  <div class="offcanvas-body d-flex flex-column" id="chatboxBody">
    <div class="chat-messages flex-grow-1 overflow-auto p-2 mb-3">
      <div class="message bot-message mb-2 p-2 rounded-3 bg-light-gray">
        Hello! I'm your NNP CU Assistant. How can I help you grow in faith today?
      </div>
      <div class="quick-replies d-flex flex-wrap gap-2 mt-2" data-aos="fade-in">
        <button class="btn btn-outline-primary-green btn-sm quick-reply-btn" data-reply="service-times">Service Times</button>
        <button class="btn btn-outline-primary-green btn-sm quick-reply-btn" data-reply="how-to-join">How to Join</button>
        <button class="btn btn-outline-primary-green btn-sm quick-reply-btn" data-reply="upcoming-events">Upcoming Events</button>
      </div>
    </div>
    <form id="chatForm" class="mt-auto">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Ask a question..." aria-label="Chat input field" id="chatInput">
        <button class="btn btn-gold" type="submit" aria-label="Send message">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send-fill" viewBox="0 0 16 16">
            <path d="M15.964.686a.5.5 0 0 0-.297-.297L.302 7.032a.5.5 0 0 0-.012.981L7.29 11.29l4.582 3.655a.5.5 0 0 0 .58-.093l3.296-6.68a.5.5 0 0 0-.014-.492z"/>
          </svg>
        </button>
      </div>
    </form>
  </div>
</div>

<!-- 🙌 Membership Modal -->
<div class="modal fade" id="membershipModal" tabindex="-1" aria-labelledby="membershipModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-deep-green text-white">
        <h5 class="modal-title" id="membershipModalLabel">Join NNP Christian Union</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p class="text-soft-gray mb-4">Fill out the form below to become an official member of our family. Welcome!</p>
        <!-- Include your membership form code here -->
      </div>
    </div>
  </div>
</div>

<!-- 🎥 Video Lightbox -->
<div class="modal fade" id="videoLightboxModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content bg-black border-0">
      <div class="modal-header border-0 pb-0">
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body pt-0">
        <div class="ratio ratio-16x9">
          <iframe id="videoPlayer" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 🖼️ Image Lightbox -->
<div class="modal fade" id="imageLightboxModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content bg-dark border-0">
      <div class="modal-header border-0 pb-0">
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body pt-0">
        <img id="lightboxImage" src="" class="img-fluid rounded-3" alt="Gallery Image">
        <div class="text-white text-center mt-2 small" id="lightboxCaption"></div>
      </div>
    </div>
  </div>
</div>
